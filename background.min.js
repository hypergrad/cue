async function togglePanel(e){try{await chrome.scripting.executeScript({target:{tabId:e},files:["content.js"]}),await chrome.tabs.sendMessage(e,{type:"CPRM_TOGGLE_PANEL"})}catch(t){try{await chrome.scripting.executeScript({target:{tabId:e},files:["content.js"]}),await chrome.tabs.sendMessage(e,{type:"CPRM_TOGGLE_PANEL"})}catch(e){console.warn("Toggle panel failed",e)}}}chrome.runtime.onInstalled.addListener(()=>{chrome.storage.local.get(["prompts","settings"],({prompts:e,settings:t})=>{e||chrome.storage.local.set({prompts:[{id:"explain",title:"解释代码",text:"逐步解释以下代码逻辑，并指出边界情况与复杂度。"},{id:"tests",title:"生成单元测试",text:"为以下函数生成单元测试，采用Arrange/Act/Assert结构。"}]}),t||chrome.storage.local.set({settings:{locale:"zh",theme:"chinese",panelWidth:380}})})}),chrome.action.onClicked.addListener(e=>{e.id&&togglePanel(e.id)}),chrome.commands.onCommand.addListener((e,t)=>{"toggle-panel"===e&&t&&t.id&&togglePanel(t.id)});